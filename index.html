<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PlaylistPro - YouTube Playlist Details Extractor</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');

    * {
      font-family: 'Poppins', sans-serif;
      box-sizing: border-box;
    }

    body {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 1rem;
      transition: background 0.5s ease;
    }

    body.dark-mode {
      background: linear-gradient(135deg, #2d3748 0%, #1a202c 100%);
    }

    .card {
      background: rgba(255, 255, 255, 0.95);
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
      border-radius: 24px;
      overflow: hidden;
      width: 100%;
      max-width: 700px;
      transition: all 0.4s ease;
    }

    .dark-mode .card {
      background: rgba(45, 55, 72, 0.95);
      color: #e2e8f0;
    }

    .input-field {
      transition: all 0.3s ease;
      border: 2px solid #e2e8f0;
      border-radius: 14px;
      padding: 1rem;
      font-size: 1rem;
      width: 100%;
    }

    .dark-mode .input-field {
      border-color: #4a5568;
      background: #2d3748;
      color: #e2e8f0;
    }

    .input-field:focus {
      border-color: #667eea;
      box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.2);
      outline: none;
    }

    .btn-primary {
      background: linear-gradient(to right, #667eea, #764ba2);
      transition: all 0.3s ease;
      border-radius: 14px;
      padding: 1rem 2rem;
      font-weight: 600;
      font-size: 1.1rem;
      width: 100%;
      border: none;
      color: white;
      cursor: pointer;
    }

    .btn-primary:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 20px rgba(102, 126, 234, 0.4);
    }

    .btn-success {
      background: linear-gradient(to right, #0f9b0f, #00c853);
      transition: all 0.3s ease;
      border-radius: 12px;
      padding: 0.75rem 1.5rem;
      border: none;
      color: white;
      cursor: pointer;
    }

    .btn-success:hover {
      transform: translateY(-2px);
      box-shadow: 0 7px 14px rgba(0, 200, 83, 0.4);
    }

    .btn-download {
      background: linear-gradient(to right, #ed8936, #f6ad55);
      transition: all 0.3s ease;
      border-radius: 12px;
      padding: 0.75rem 1.5rem;
      border: none;
      color: white;
      cursor: pointer;
    }

    .btn-download:hover {
      transform: translateY(-2px);
      box-shadow: 0 7px 14px rgba(237, 137, 54, 0.4);
    }

    .result-container {
      max-height: 400px;
      overflow-y: auto;
      scrollbar-width: thin;
      scrollbar-color: #cbd5e0 #f7fafc;
      border-radius: 16px;
      background: #f8fafc;
      padding: 1.5rem;
    }

    .dark-mode .result-container {
      background: #1a202c;
      scrollbar-color: #4a5568 #2d3748;
    }

    .result-container::-webkit-scrollbar {
      width: 8px;
    }

    .result-container::-webkit-scrollbar-track {
      background: #f7fafc;
      border-radius: 4px;
    }

    .dark-mode .result-container::-webkit-scrollbar-track {
      background: #2d3748;
    }

    .result-container::-webkit-scrollbar-thumb {
      background: #cbd5e0;
      border-radius: 4px;
    }

    .dark-mode .result-container::-webkit-scrollbar-thumb {
      background: #4a5568;
    }

    .tooltip {
      visibility: hidden;
      opacity: 0;
      transition: opacity 0.3s, visibility 0.3s, transform 0.3s;
      transform: translateY(5px);
    }

    .tooltip.show {
      visibility: visible;
      opacity: 1;
      transform: translateY(0);
    }

    .fade-in {
      animation: fadeIn 0.5s ease-in-out;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .pulse {
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.03); }
      100% { transform: scale(1); }
    }

    .progress-bar {
      height: 6px;
      border-radius: 3px;
      background: #e2e8f0;
      overflow: hidden;
      margin-top: 1rem;
    }

    .dark-mode .progress-bar {
      background: #4a5568;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(to right, #667eea, #764ba2);
      border-radius: 3px;
      width: 0%;
      transition: width 0.5s ease;
    }

    .json-output {
      white-space: pre-wrap;
      word-break: break-all;
      font-size: 0.85rem;
      line-height: 1.4;
      background: #2d3748;
      color: #e2e8f0;
      padding: 1.5rem;
      border-radius: 12px;
      overflow-x: auto;
    }

    .dark-mode .json-output {
      background: #1a202c;
      border: 1px solid #4a5568;
    }

    .toggle-container {
      position: absolute;
      top: 1rem;
      right: 1rem;
    }

    .theme-toggle {
      background: none;
      border: none;
      cursor: pointer;
      font-size: 1.5rem;
      color: #fff;
      transition: transform 0.3s ease;
    }

    .theme-toggle:hover {
      transform: rotate(20deg);
    }

    @media (max-width: 640px) {
      .card {
        padding: 1.5rem;
        border-radius: 20px;
      }

      .input-field {
        padding: 0.875rem;
        font-size: 16px;
      }

      .btn-primary, .btn-success, .btn-download {
        padding: 0.875rem 1.5rem;
        font-size: 1rem;
      }

      .result-container {
        padding: 1rem;
      }

      .json-output {
        padding: 1rem;
        font-size: 0.75rem;
      }

      .toggle-container {
        top: 0.5rem;
        right: 0.5rem;
      }
    }
  </style>
</head>
<body>
  <div class="toggle-container">
    <button class="theme-toggle" onclick="toggleTheme()">
      <i class="fas fa-moon"></i>
    </button>
  </div>

  <div class="card p-6 md:p-8">
    <div class="text-center mb-8">
      <div class="inline-flex items-center justify-center w-20 h-20 bg-blue-100 rounded-full mb-4 animate-spin-slow">
        <i class="fab fa-youtube text-red-600 text-4xl"></i>
      </div>
      <h1 class="text-3xl md:text-4xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-blue-600 to-purple-600">
        PlaylistPro
      </h1>
      <p class="text-gray-600 mt-2 dark:text-gray-300">Extract and customize YouTube playlist details</p>
    </div>

    <div class="mb-6 bg-blue-50 p-4 rounded-xl border border-blue-200 flex items-start dark:bg-gray-700 dark:border-gray-600">
      <div class="mr-3 mt-1 text-blue-500 dark:text-blue-300">
        <i class="fas fa-info-circle"></i>
      </div>
      <p class="text-blue-700 text-sm dark:text-blue-200">
        <span class="font-medium">How it works:</span> Paste a YouTube playlist link, specify a category and ID range, and extract video details with custom parameters.
      </p>
    </div>

    <div class="mb-6">
      <label for="playlistLink" class="block text-sm font-medium text-gray-700 mb-2 flex items-center dark:text-gray-300">
        <span class="bg-blue-100 text-blue-600 rounded-full w-6 h-6 flex items-center justify-center text-xs mr-2 dark:bg-blue-800 dark:text-blue-200">1</span>
        YouTube Playlist Link
      </label>
      <div class="flex items-center">
        <span class="text-red-600 mr-2 text-xl"><i class="fab fa-youtube"></i></span>
        <input
          type="text"
          id="playlistLink"
          placeholder="https://www.youtube.com/playlist?list=..."
          class="input-field focus:outline-none focus:ring-0"
        />
      </div>
    </div>

    <div class="mb-6 grid grid-cols-1 md:grid-cols-2 gap-4">
      <div>
        <label for="category" class="block text-sm font-medium text-gray-700 mb-2 flex items-center dark:text-gray-300">
          <span class="bg-blue-100 text-blue-600 rounded-full w-6 h-6 flex items-center justify-center text-xs mr-2 dark:bg-blue-800 dark:text-blue-200">2</span>
          Category
        </label>
        <input
          type="text"
          id="category"
          placeholder="e.g., Chhota Bheem"
          class="input-field focus:outline-none focus:ring-0"
        />
      </div>
      <div>
        <label for="idRange" class="block text-sm font-medium text-gray-700 mb-2 flex items-center dark:text-gray-300">
          <span class="bg-blue-100 text-blue-600 rounded-full w-6 h-6 flex items-center justify-center text-xs mr-2 dark:bg-blue-800 dark:text-blue-200">3</span>
          ID Range (e.g., 1-20)
        </label>
        <input
          type="text"
          id="idRange"
          placeholder="e.g., 1-20"
          class="input-field focus:outline-none focus:ring-0"
        />
      </div>
    </div>

    <button
      onclick="fetchPlaylistDetails()"
      class="btn-primary flex items-center justify-center pulse mb-6"
    >
      <i class="fas fa-bolt mr-3"></i>Extract Playlist Details
    </button>

    <div class="progress-bar hidden" id="progressContainer">
      <div class="progress-fill" id="progressFill"></div>
    </div>

    <div id="loading" class="hidden mt-8 text-center py-8">
      <div class="inline-flex items-center justify-center w-16 h-16 bg-blue-100 rounded-full mb-4 dark:bg-blue-800">
        <i class="fas fa-spinner fa-spin text-2xl text-blue-500 dark:text-blue-300"></i>
      </div>
      <p class="text-gray-600 dark:text-gray-300">Fetching playlist details from YouTube...</p>
      <p class="text-gray-500 text-sm mt-2 dark:text-gray-400" id="statusText">Initializing</p>
    </div>

    <div id="result" class="mt-8 hidden fade-in">
      <div class="flex items-center justify-between mb-4">
        <h2 class="text-xl font-bold text-gray-800 flex items-center dark:text-gray-200">
          <i class="fas fa-list-alt mr-2 text-blue-500 dark:text-blue-300"></i>Playlist Details
        </h2>
        <span id="resultCount" class="bg-blue-100 text-blue-800 text-sm font-medium px-3 py-1 rounded-full dark:bg-blue-800 dark:text-blue-200"></span>
      </div>

      <div class="result-container mb-6">
        <div class="json-output" id="output"></div>
      </div>

      <div class="flex flex-wrap justify-between items-center gap-4">
        <button
          id="copyButton"
          onclick="copyToClipboard()"
          class="btn-success flex items-center relative"
        >
          <i class="fas fa-copy mr-2"></i>Copy JSON
          <span id="tooltip" class="tooltip absolute -top-10 bg-gray-800 text-white text-xs rounded py-1 px-2">Copied to clipboard!</span>
        </button>

        <button
          id="downloadButton"
          onclick="downloadJSON()"
          class="btn-download flex items-center"
        >
          <i class="fas fa-download mr-2"></i>Download JSON
        </button>

        <button
          onclick="clearAllFields()"
          class="text-gray-500 hover:text-gray-700 flex items-center bg-transparent border-none dark:text-gray-400 dark:hover:text-gray-200"
        >
          <i class="fas fa-trash-alt mr-2"></i>Clear All
        </button>
      </div>
    </div>

    <div id="error" class="mt-6 p-4 bg-red-50 text-red-700 rounded-lg border border-red-200 hidden fade-in dark:bg-red-900 dark:text-red-200 dark:border-red-800">
      <div class="flex items-start">
        <i class="fas fa-exclamation-circle mt-1 mr-3"></i>
        <div>
          <span class="font-medium">Error:</span>
          <span id="errorText"></span>
        </div>
      </div>
    </div>
  </div>

  <script>
    function toggleTheme() {
      document.body.classList.toggle('dark-mode');
      const toggleIcon = document.querySelector('.theme-toggle i');
      toggleIcon.classList.toggle('fa-moon');
      toggleIcon.classList.toggle('fa-sun');
    }

    function extractPlaylistId(url) {
      const regex = /[?&]list=([^"&?\/\s]+)/;
      const match = url.match(regex);
      return match ? match[1] : null;
    }

    function parseIdRange(idRange) {
      const regex = /^(\d+)-(\d+)$/;
      const match = idRange.match(regex);
      if (!match) return null;
      const start = parseInt(match[1]);
      const end = parseInt(match[2]);
      if (start > end || start < 1) return null;
      return { start, end };
    }

    async function fetchPlaylistDetails() {
      const playlistLink = document.getElementById('playlistLink').value;
      const category = document.getElementById('category').value.trim();
      const idRange = document.getElementById('idRange').value.trim();
      const resultDiv = document.getElementById('result');
      const outputElement = document.getElementById('output');
      const errorDiv = document.getElementById('error');
      const errorText = document.getElementById('errorText');
      const loadingDiv = document.getElementById('loading');
      const resultCount = document.getElementById('resultCount');
      const progressContainer = document.getElementById('progressContainer');
      const progressFill = document.getElementById('progressFill');
      const statusText = document.getElementById('statusText');

      // Reset display
      resultDiv.classList.add('hidden');
      errorDiv.classList.add('hidden');
      loadingDiv.classList.remove('hidden');
      progressContainer.classList.remove('hidden');
      outputElement.textContent = '';
      progressFill.style.width = '0%';

      // Extract playlist ID
      const playlistId = extractPlaylistId(playlistLink);
      if (!playlistId) {
        loadingDiv.classList.add('hidden');
        progressContainer.classList.add('hidden');
        errorText.textContent = 'Invalid YouTube playlist URL. Please enter a valid playlist link.';
        errorDiv.classList.remove('hidden');
        return;
      }

      // Validate ID range
      const idRangeObj = parseIdRange(idRange);
      if (!idRangeObj) {
        loadingDiv.classList.add('hidden');
        progressContainer.classList.add('hidden');
        errorText.textContent = 'Invalid ID range. Please enter a valid range (e.g., 1-20).';
        errorDiv.classList.remove('hidden');
        return;
      }

      const apiKey = 'AIzaSyD12wYSNog79Ifn2dQTqCtnqQreazxPx78';
      const output = [];
      const errors = [];
      let videoIds = [];
      let nextPageToken = '';
      let totalVideos = 0;
      let processedVideos = 0;

      try {
        statusText.textContent = 'Fetching playlist information...';

        // Fetch all video IDs from the playlist
        do {
          const playlistUrl = `https://www.googleapis.com/youtube/v3/playlistItems?part=contentDetails&playlistId=${playlistId}&maxResults=50&key=${apiKey}${nextPageToken ? `&pageToken=${nextPageToken}` : ''}`;
          const playlistResponse = await fetch(playlistUrl);
          if (!playlistResponse.ok) {
            throw new Error('Failed to fetch playlist items. Check API key or network.');
          }
          const playlistData = await playlistResponse.json();
          videoIds = videoIds.concat(playlistData.items.map(item => item.contentDetails.videoId));
          nextPageToken = playlistData.nextPageToken || '';

          if (!totalVideos && playlistData.pageInfo) {
            totalVideos = playlistData.pageInfo.totalResults;
          }

          statusText.textContent = `Found ${videoIds.length} videos...`;
          progressFill.style.width = `${Math.min(20, (videoIds.length / totalVideos) * 20)}%`;
        } while (nextPageToken);

        if (videoIds.length === 0) {
          throw new Error('No videos found in the playlist.');
        }

        if (videoIds.length > idRangeObj.end - idRangeObj.start + 1) {
          throw new Error(`ID range (${idRange}) is too small for ${videoIds.length} videos.`);
        }

        // Fetch video details in batches of 50
        for (let i = 0; i < videoIds.length; i += 50) {
          const batchIds = videoIds.slice(i, i + 50).join(',');
          const videoUrl = `https://www.googleapis.com/youtube/v3/videos?part=snippet,statistics&id=${batchIds}&key=${apiKey}`;
          statusText.textContent = `Fetching details for videos ${i+1} to ${Math.min(i+50, videoIds.length)}...`;

          const videoResponse = await fetch(videoUrl);
          if (!videoResponse.ok) {
            throw new Error('Failed to fetch video details.');
          }
          const videoData = await videoResponse.json();

          videoData.items.forEach((video, index) => {
            const result = {
              id: idRangeObj.start + processedVideos,
              category: category || 'N/A',
              title: video.snippet.title || 'N/A',
              youtubeLink: video.id,
              thumbnailUrl: `https://i.ytimg.com/vi/${video.id}/hqdefault.jpg`,
              description: video.snippet.description ? 
                video.snippet.description.substring(0, 100) + 
                (video.snippet.description.length > 100 ? '...' : '') : 'N/A',
              views: parseInt(video.statistics.viewCount) || 0,
              uploadDate: new Date(video.snippet.publishedAt).toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
              }) || 'N/A'
            };
            output.push(result);

            processedVideos++;
            progressFill.style.width = `${20 + (processedVideos / videoIds.length) * 80}%`;
          });
        }

        // Update result count
        resultCount.textContent = `${output.length} video${output.length !== 1 ? 's' : ''} extracted`;

        // Format and display output
        const formattedOutput = JSON.stringify(output, null, 2);
        outputElement.textContent = formattedOutput;

        // Display output
        resultDiv.classList.remove('hidden');
        if (errors.length > 0) {
          errorText.textContent = errors.join(', ');
          errorDiv.classList.remove('hidden');
        }
      } catch (error) {
        console.error(error);
        errorText.textContent = error.message || 'Could not fetch playlist details. Please check your API key and try again.';
        errorDiv.classList.remove('hidden');
      } finally {
        loadingDiv.classList.add('hidden');
        progressContainer.classList.add('hidden');
      }
    }

    function copyToClipboard() {
      const outputElement = document.getElementById('output');
      const tooltip = document.getElementById('tooltip');

      navigator.clipboard.writeText(outputElement.textContent).then(() => {
        tooltip.classList.add('show');
        setTimeout(() => tooltip.classList.remove('show'), 2000);
      }).catch(err => {
        console.error('Failed to copy:', err);
        alert('Failed to copy to clipboard. Please try again.');
      });
    }

    function downloadJSON() {
      const outputElement = document.getElementById('output');
      const category = document.getElementById('category').value.trim() || 'playlist';
      const data = outputElement.textContent;
      const blob = new Blob([data], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `${category}_playlist.json`;
      a.click();
      URL.revokeObjectURL(url);
    }

    function clearAllFields() {
      document.getElementById('playlistLink').value = '';
      document.getElementById('category').value = '';
      document.getElementById('idRange').value = '';

      const resultDiv = document.getElementById('result');
      const errorDiv = document.getElementById('error');
      resultDiv.classList.add('hidden');
      errorDiv.classList.add('hidden');

      const outputElement = document.getElementById('output');
      outputElement.textContent = '';
    }
  </script>
</body>
</html>
